(function(){function Q(l,v,s){"use strict";var e=jQuery(v),t=jQuery(s);if(e.length===0)throw Error("No element selected by the searchSelector");if(t.length===0)throw Error("No element selected by the resultSelector");t.attr("class").indexOf("list-group-item")===-1&&t.html('<div class="m-auto text-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div><br/>Loading...</div>'),jQuery.ajax({url:l,dataType:"xml",success:function(E){var L=jQuery("entry",E).map(function(){return{title:jQuery("title",this).text(),content:jQuery("content",this).text(),url:jQuery("url",this).text()}}).get();t.html().indexOf("list-group-item")===-1&&t.html(""),e.on("input",function(){var x=e.val(),n="",C=x.trim().toLowerCase().split(/[\s-]+/);if(t.html(""),x.trim().length<=0)return e.removeClass("invalid").removeClass("valid");if(L.forEach(function(r){var f=!0;(!r.title||r.title.trim()==="")&&(r.title="Untitled");var j=r.title.trim(),O=j.toLowerCase(),_=r.content.trim().replace(/<[^>]+>/g,""),b=_.toLowerCase(),N=r.url,w=-1,i=-1,o=-1;if(CONFIG.include_content_in_search&&b===""?f=!1:C.forEach(function(a,p){w=O.indexOf(a),i=b.indexOf(a),w<0&&i<0?f=!1:(i<0&&(i=0),p===0&&(o=i))}),f){n+="<a href='"+N+"' class='list-group-item list-group-item-action font-weight-bolder search-list-title'>"+j+"</a>";var d=_;if(o>=0){var c=o-20,u=o+80;c<0&&(c=0),c===0&&(u=100),u>d.length&&(u=d.length);var m=d.substring(c,u);C.forEach(function(a){var p=new RegExp(a,"gi");m=m.replace(p,'<span class="search-word">'+a+"</span>")}),n+="<p class='search-list-content'>"+m+"...</p>"}}}),n.indexOf("list-group-item")===-1)return e.addClass("invalid").removeClass("valid");e.addClass("valid").removeClass("invalid"),t.html(n)})}})}function S(l,v){"use strict";var s=jQuery(l),e=jQuery(v);if(s.length===0)throw Error("No element selected by the searchSelector");if(e.length===0)throw Error("No element selected by the resultSelector");s.val("").removeClass("invalid").removeClass("valid"),e.html("")}var h=jQuery("#modalSearch"),g="#local-search-input",y="#local-search-result";h.on("show.bs.modal",function(){var l=CONFIG.search_path||"/local-search.xml";Q(l,g,y)}),h.on("shown.bs.modal",function(){jQuery("#local-search-input").focus()}),h.on("hidden.bs.modal",function(){S(g,y)})})();
